<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tarefa4</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Tarefa4.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Tarefa4</p></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:avanca">avanca</a> :: [String] -&gt; Float -&gt; [String]</li><li class="src short"><a href="#v:auxiliar">auxiliar</a> :: [String] -&gt; Float -&gt; [String]</li><li class="src short"><a href="#v:bombaT1">bombaT1</a> :: [((Int, Int), Int, Int, Int)] -&gt; [((Int, Int), Int, Int, Int)]</li><li class="src short"><a href="#v:verificaRaioCima1">verificaRaioCima1</a> :: [String] -&gt; Int -&gt; Int -&gt; Int -&gt; ((Int, Int), Int, Int, Int) -&gt; Int</li><li class="src short"><a href="#v:verificaRaioBaixo1">verificaRaioBaixo1</a> :: [String] -&gt; Int -&gt; Int -&gt; Int -&gt; ((Int, Int), Int, Int, Int) -&gt; Int</li><li class="src short"><a href="#v:verificaRaioEsquerda1">verificaRaioEsquerda1</a> :: [String] -&gt; Int -&gt; Int -&gt; Int -&gt; ((Int, Int), Int, Int, Int) -&gt; Int</li><li class="src short"><a href="#v:verificaRaioDireita1">verificaRaioDireita1</a> :: [String] -&gt; Int -&gt; Int -&gt; Int -&gt; ((Int, Int), Int, Int, Int) -&gt; Int</li><li class="src short"><a href="#v:bombasExplodeFinalmente">bombasExplodeFinalmente</a> :: [((Int, Int), Int, Int, Int)] -&gt; [String] -&gt; [String]</li><li class="src short"><a href="#v:explodeBomba">explodeBomba</a> :: [String] -&gt; ((Int, Int), Int, Int, Int) -&gt; [String]</li><li class="src short"><a href="#v:explodeCima">explodeCima</a> :: [String] -&gt; (Int, Int) -&gt; Int -&gt; Int -&gt; Int -&gt; [String]</li><li class="src short"><a href="#v:explodeBaixo">explodeBaixo</a> :: [String] -&gt; (Int, Int) -&gt; Int -&gt; Int -&gt; Int -&gt; [String]</li><li class="src short"><a href="#v:explodeHorizontal">explodeHorizontal</a> :: [String] -&gt; (Int, Int) -&gt; Int -&gt; Int -&gt; Int -&gt; [String]</li><li class="src short"><a href="#v:apagaPontosHorizontal">apagaPontosHorizontal</a> :: String -&gt; Int -&gt; Int -&gt; Int -&gt; String</li><li class="src short"><a href="#v:apagaPontos">apagaPontos</a> :: String -&gt; Int -&gt; Int -&gt; String</li><li class="src short"><a href="#v:bombasColocadasInf">bombasColocadasInf</a> :: [String] -&gt; [((Int, Int), Int, Int, Int)]</li><li class="src short"><a href="#v:coordenadasBombasColocadas">coordenadasBombasColocadas</a> :: String -&gt; Int -&gt; String</li><li class="src short"><a href="#v:primeiraCoordenada">primeiraCoordenada</a> :: String -&gt; String</li><li class="src short"><a href="#v:segundaCoordenada">segundaCoordenada</a> :: String -&gt; Int -&gt; String</li><li class="src short"><a href="#v:converteCoordenadas">converteCoordenadas</a> :: String -&gt; (Int, Int)</li><li class="src short"><a href="#v:arranjaRaio">arranjaRaio</a> :: String -&gt; Int -&gt; Int</li><li class="src short"><a href="#v:arranjaJogador">arranjaJogador</a> :: String -&gt; Int -&gt; Int</li><li class="src short"><a href="#v:arranjaTempo">arranjaTempo</a> :: String -&gt; Int -&gt; String</li><li class="src short"><a href="#v:converteTempo">converteTempo</a> :: String -&gt; Int</li><li class="src short"><a href="#v:informacaoBomba">informacaoBomba</a> :: String -&gt; ((Int, Int), Int, Int, Int)</li><li class="src short"><a href="#v:apagaBombasExplodidas">apagaBombasExplodidas</a> :: [String] -&gt; [String]</li><li class="src short"><a href="#v:zonaExplosao">zonaExplosao</a> :: ((Int, Int), Int, Int, Int) -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; (Int, Int, Int, Int, (Int, Int))</li><li class="src short"><a href="#v:percorreMapa">percorreMapa</a> :: [String] -&gt; (Int, Int, Int) -&gt; (Int, Int, Int, Int, (Int, Int)) -&gt; [String]</li><li class="src short"><a href="#v:zonaExplosaoList">zonaExplosaoList</a> :: [String] -&gt; [((Int, Int), Int, Int, Int)] -&gt; [(Int, Int, Int, Int, (Int, Int))]</li><li class="src short"><a href="#v:percorreMapa2">percorreMapa2</a> :: [String] -&gt; [(Int, Int, Int)] -&gt; (Int, Int, Int, Int, (Int, Int)) -&gt; [String]</li><li class="src short"><a href="#v:percorreMapa3">percorreMapa3</a> :: [String] -&gt; [(Int, Int, Int)] -&gt; [(Int, Int, Int, Int, (Int, Int))] -&gt; [String]</li><li class="src short"><a href="#v:verificaBomba">verificaBomba</a> :: ((Int, Int), Int, Int, Int) -&gt; (Int, Int, Int, Int, (Int, Int)) -&gt; String</li><li class="src short"><a href="#v:percorreMapBomb">percorreMapBomb</a> :: [String] -&gt; (Int, Int, Int, Int, (Int, Int)) -&gt; [String]</li><li class="src short"><a href="#v:percorreMapBomb2">percorreMapBomb2</a> :: [String] -&gt; [(Int, Int, Int, Int, (Int, Int))] -&gt; [String]</li><li class="src short"><a href="#v:getJogadores">getJogadores</a> :: [String] -&gt; [String]</li><li class="src short"><a href="#v:fstCoordJog">fstCoordJog</a> :: String -&gt; Int -&gt; String</li><li class="src short"><a href="#v:sndCoordJog">sndCoordJog</a> :: String -&gt; Int -&gt; String</li><li class="src short"><a href="#v:jogador">jogador</a> :: String -&gt; Char</li><li class="src short"><a href="#v:jogadoresAux">jogadoresAux</a> :: [String] -&gt; [(Int, Int, Int)]</li><li class="src short"><a href="#v:jogadoresInf">jogadoresInf</a> :: [String] -&gt; [(Int, Int, Int)]</li><li class="src short"><a href="#v:alteraBombaEstado">alteraBombaEstado</a> :: String -&gt; String</li><li class="src short"><a href="#v:escreveBomba">escreveBomba</a> :: ((Int, Int), Int, Int, Int) -&gt; String</li><li class="src short"><a href="#v:alteraBombas">alteraBombas</a> :: [String] -&gt; [String]</li><li class="src short"><a href="#v:condicaoEspiral">condicaoEspiral</a> :: Int -&gt; [String] -&gt; Bool</li><li class="src short"><a href="#v:contaLinhas">contaLinhas</a> :: [String] -&gt; Int</li><li class="src short"><a href="#v:coordenadaEspiralDireita">coordenadaEspiralDireita</a> :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Float -&gt; [(Int, Int)]</li><li class="src short"><a href="#v:coordenadaEspiralBaixo">coordenadaEspiralBaixo</a> :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Float -&gt; [(Int, Int)]</li><li class="src short"><a href="#v:coordenadaEspiralEsquerda">coordenadaEspiralEsquerda</a> :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Float -&gt; [(Int, Int)]</li><li class="src short"><a href="#v:coordenadaEspiralCima">coordenadaEspiralCima</a> :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Float -&gt; [(Int, Int)]</li><li class="src short"><a href="#v:desenhaEspiral">desenhaEspiral</a> :: [(Int, Int)] -&gt; [String] -&gt; Int -&gt; Int -&gt; Int -&gt; [String]</li><li class="src short"><a href="#v:desenhaLinhA">desenhaLinhA</a> :: [(Int, Int)] -&gt; String -&gt; Int -&gt; Int -&gt; Int -&gt; String</li><li class="src short"><a href="#v:verificaCondicao">verificaCondicao</a> :: [(Int, Int)] -&gt; Int -&gt; Int -&gt; Bool</li><li class="src short"><a href="#v:main">main</a> :: IO ()</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a name="v:avanca" class="def">avanca</a> :: [String] -&gt; Float -&gt; [String]</p><div class="doc"><p>Fun&#231;&#227;o principal </p></div></div><div class="top"><p class="src"><a name="v:auxiliar" class="def">auxiliar</a> :: [String] -&gt; Float -&gt; [String]</p><div class="doc"><p>Fun&#231;&#227;o principal para facilitar a leitura</p></div></div><div class="top"><p class="src"><a name="v:bombaT1" class="def">bombaT1</a> :: [((Int, Int), Int, Int, Int)] -&gt; [((Int, Int), Int, Int, Int)]</p><div class="doc"><p>Guarda todas as bombas com tempo = 1 </p></div></div><div class="top"><p class="src"><a name="v:verificaRaioCima1" class="def">verificaRaioCima1</a> :: [String] -&gt; Int -&gt; Int -&gt; Int -&gt; ((Int, Int), Int, Int, Int) -&gt; Int</p><div class="doc"><p>Define at&#233; onde pode a bomba alcan&#231;ar em cima </p></div></div><div class="top"><p class="src"><a name="v:verificaRaioBaixo1" class="def">verificaRaioBaixo1</a> :: [String] -&gt; Int -&gt; Int -&gt; Int -&gt; ((Int, Int), Int, Int, Int) -&gt; Int</p><div class="doc"><p>Define at&#233; onde pode a bomba alcan&#231;ar em baixo </p></div></div><div class="top"><p class="src"><a name="v:verificaRaioEsquerda1" class="def">verificaRaioEsquerda1</a> :: [String] -&gt; Int -&gt; Int -&gt; Int -&gt; ((Int, Int), Int, Int, Int) -&gt; Int</p><div class="doc"><p>Define at&#233; onde pode a bomba alcan&#231;ar &#224; esquerda </p></div></div><div class="top"><p class="src"><a name="v:verificaRaioDireita1" class="def">verificaRaioDireita1</a> :: [String] -&gt; Int -&gt; Int -&gt; Int -&gt; ((Int, Int), Int, Int, Int) -&gt; Int</p><div class="doc"><p>Define at&#233; onde pode a bomba alcan&#231;ar &#224; direita </p></div></div><div class="top"><p class="src"><a name="v:bombasExplodeFinalmente" class="def">bombasExplodeFinalmente</a> :: [((Int, Int), Int, Int, Int)] -&gt; [String] -&gt; [String]</p><div class="doc"><p>Todas as bombas que tiverem com o tempo igual a 1 iram rebentar</p></div></div><div class="top"><p class="src"><a name="v:explodeBomba" class="def">explodeBomba</a> :: [String] -&gt; ((Int, Int), Int, Int, Int) -&gt; [String]</p><div class="doc"><p>Apenas uma bomba que tiverem com o tempo igual a 1 iram rebentar</p></div></div><div class="top"><p class="src"><a name="v:explodeCima" class="def">explodeCima</a> :: [String] -&gt; (Int, Int) -&gt; Int -&gt; Int -&gt; Int -&gt; [String]</p></div><div class="top"><p class="src"><a name="v:explodeBaixo" class="def">explodeBaixo</a> :: [String] -&gt; (Int, Int) -&gt; Int -&gt; Int -&gt; Int -&gt; [String]</p><div class="doc"><p>Rebenta tudo o que estiver em baixo at&#233; alcan&#231;ar o m&#225;ximo do raio </p></div></div><div class="top"><p class="src"><a name="v:explodeHorizontal" class="def">explodeHorizontal</a> :: [String] -&gt; (Int, Int) -&gt; Int -&gt; Int -&gt; Int -&gt; [String]</p><div class="doc"><p>Rebenta tudo o que estiver &#224; esquerda e direita at&#233; ao m&#225;ximo do raio </p></div></div><div class="top"><p class="src"><a name="v:apagaPontosHorizontal" class="def">apagaPontosHorizontal</a> :: String -&gt; Int -&gt; Int -&gt; Int -&gt; String</p><div class="doc"><p>Apaga tudo o que tiver na horizontal </p></div></div><div class="top"><p class="src"><a name="v:apagaPontos" class="def">apagaPontos</a> :: String -&gt; Int -&gt; Int -&gt; String</p><div class="doc"><p>Apaga tudo o que tiver na coluna</p></div></div><div class="top"><p class="src"><a name="v:bombasColocadasInf" class="def">bombasColocadasInf</a> :: [String] -&gt; [((Int, Int), Int, Int, Int)]</p><div class="doc"><p>Converte as bombas colocadas em informa&#231;&#227;o</p></div></div><div class="top"><p class="src"><a name="v:coordenadasBombasColocadas" class="def">coordenadasBombasColocadas</a> :: String -&gt; Int -&gt; String</p><div class="doc"><p>Percorre a string e guarda as coordenadas das bombas colocadas </p></div></div><div class="top"><p class="src"><a name="v:primeiraCoordenada" class="def">primeiraCoordenada</a> :: String -&gt; String</p><div class="doc"><p>Devolve a 1&#170; coordenada da string, neste caso a coluna. (Ex: primeiraCoordenada &quot;2 3&quot; -&gt; 2)</p></div></div><div class="top"><p class="src"><a name="v:segundaCoordenada" class="def">segundaCoordenada</a> :: String -&gt; Int -&gt; String</p><div class="doc"><p>Devolve a 2&#170; coordenada da string, neste caso a linha. (Ex: segundaCoordenada &quot;2 3&quot; -&gt; 3)</p></div></div><div class="top"><p class="src"><a name="v:converteCoordenadas" class="def">converteCoordenadas</a> :: String -&gt; (Int, Int)</p><div class="doc"><p>Guarda s&#243; a linha e coluna da bomba</p></div></div><div class="top"><p class="src"><a name="v:arranjaRaio" class="def">arranjaRaio</a> :: String -&gt; Int -&gt; Int</p><div class="doc"><p>Percorre a string e guarda o raio da bomba colocada </p></div></div><div class="top"><p class="src"><a name="v:arranjaJogador" class="def">arranjaJogador</a> :: String -&gt; Int -&gt; Int</p><div class="doc"><p>Percorre a string e guarda o jogador que colocou a bomba </p></div></div><div class="top"><p class="src"><a name="v:arranjaTempo" class="def">arranjaTempo</a> :: String -&gt; Int -&gt; String</p><div class="doc"><p>Percorre a string e guarda o tempo que falta para a bomba rebentar </p></div></div><div class="top"><p class="src"><a name="v:converteTempo" class="def">converteTempo</a> :: String -&gt; Int</p><div class="doc"><p>Converte o tempo para inteiro </p></div></div><div class="top"><p class="src"><a name="v:informacaoBomba" class="def">informacaoBomba</a> :: String -&gt; ((Int, Int), Int, Int, Int)</p><div class="doc"><p>Guarda a informa&#231;&#227;o da bomba na forma de ((col,lin),jog,raio,tempo)</p></div></div><div class="top"><p class="src"><a name="v:apagaBombasExplodidas" class="def">apagaBombasExplodidas</a> :: [String] -&gt; [String]</p><div class="doc"><p>Apaga as bombas que explodiram no estado de jogo </p></div></div><div class="top"><p class="src"><a name="v:zonaExplosao" class="def">zonaExplosao</a> :: ((Int, Int), Int, Int, Int) -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; (Int, Int, Int, Int, (Int, Int))</p><div class="doc"><p>V&#233; a zona da explos&#227;o </p></div></div><div class="top"><p class="src"><a name="v:percorreMapa" class="def">percorreMapa</a> :: [String] -&gt; (Int, Int, Int) -&gt; (Int, Int, Int, Int, (Int, Int)) -&gt; [String]</p></div><div class="top"><p class="src"><a name="v:zonaExplosaoList" class="def">zonaExplosaoList</a> :: [String] -&gt; [((Int, Int), Int, Int, Int)] -&gt; [(Int, Int, Int, Int, (Int, Int))]</p><div class="doc"><p>Guarda todas as zonas de explos&#227;o possiveis </p></div></div><div class="top"><p class="src"><a name="v:percorreMapa2" class="def">percorreMapa2</a> :: [String] -&gt; [(Int, Int, Int)] -&gt; (Int, Int, Int, Int, (Int, Int)) -&gt; [String]</p><div class="doc"><p>Percorre o mapa e rebenta a bomba tudo o que estiver no alcance</p></div></div><div class="top"><p class="src"><a name="v:percorreMapa3" class="def">percorreMapa3</a> :: [String] -&gt; [(Int, Int, Int)] -&gt; [(Int, Int, Int, Int, (Int, Int))] -&gt; [String]</p><div class="doc"><p>Percorre o mapa e rebenta todas as bombas que est&#227;o prestes a explodir </p></div></div><div class="top"><p class="src"><a name="v:verificaBomba" class="def">verificaBomba</a> :: ((Int, Int), Int, Int, Int) -&gt; (Int, Int, Int, Int, (Int, Int)) -&gt; String</p><div class="doc"><p>Verifica se a bomba est&#225; no alcance da outra e se estiver muda de tempo para 1 </p></div></div><div class="top"><p class="src"><a name="v:percorreMapBomb" class="def">percorreMapBomb</a> :: [String] -&gt; (Int, Int, Int, Int, (Int, Int)) -&gt; [String]</p><div class="doc"><p>Percorre o mapa e muda o estado da bomba </p></div></div><div class="top"><p class="src"><a name="v:percorreMapBomb2" class="def">percorreMapBomb2</a> :: [String] -&gt; [(Int, Int, Int, Int, (Int, Int))] -&gt; [String]</p><div class="doc"><p>Percorre o mapa e muda todos os estados das bombas </p></div></div><div class="top"><p class="src"><a name="v:getJogadores" class="def">getJogadores</a> :: [String] -&gt; [String]</p><div class="doc"><p>Percorre o mapa e guarda os jogadores </p></div></div><div class="top"><p class="src"><a name="v:fstCoordJog" class="def">fstCoordJog</a> :: String -&gt; Int -&gt; String</p><div class="doc"><p>Guarda a coluna</p></div></div><div class="top"><p class="src"><a name="v:sndCoordJog" class="def">sndCoordJog</a> :: String -&gt; Int -&gt; String</p><div class="doc"><p>Guarda a linha</p></div></div><div class="top"><p class="src"><a name="v:jogador" class="def">jogador</a> :: String -&gt; Char</p><div class="doc"><p>Guarda o jogador</p></div></div><div class="top"><p class="src"><a name="v:jogadoresAux" class="def">jogadoresAux</a> :: [String] -&gt; [(Int, Int, Int)]</p><div class="doc"><p>Guarda a informa&#231;&#227;o dos jogadores em forma de (coluna,linha,jogador)</p></div></div><div class="top"><p class="src"><a name="v:jogadoresInf" class="def">jogadoresInf</a> :: [String] -&gt; [(Int, Int, Int)]</p><div class="doc"><p>Percorre o mapa e guarda e depois converte a informa&#231;&#227;o dos jogadores com a ajuda da fun&#231;&#227;o jogadoresAux </p></div></div><div class="top"><p class="src"><a name="v:alteraBombaEstado" class="def">alteraBombaEstado</a> :: String -&gt; String</p><div class="doc"><p>Altera o estado da bomba </p></div></div><div class="top"><p class="src"><a name="v:escreveBomba" class="def">escreveBomba</a> :: ((Int, Int), Int, Int, Int) -&gt; String</p><div class="doc"><p>Muda o tempo da bomba </p></div></div><div class="top"><p class="src"><a name="v:alteraBombas" class="def">alteraBombas</a> :: [String] -&gt; [String]</p><div class="doc"><p>Altera o tempo de  todas as bombas </p></div></div><div class="top"><p class="src"><a name="v:condicaoEspiral" class="def">condicaoEspiral</a> :: Int -&gt; [String] -&gt; Bool</p><div class="doc"><p>Verifica se j&#225; cumpre a condi&#231;&#227;o do efeito da espiral</p></div></div><div class="top"><p class="src"><a name="v:contaLinhas" class="def">contaLinhas</a> :: [String] -&gt; Int</p><div class="doc"><p>Conta o n&#186; de linhas do mapa</p></div></div><div class="top"><p class="src"><a name="v:coordenadaEspiralDireita" class="def">coordenadaEspiralDireita</a> :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Float -&gt; [(Int, Int)]</p><div class="doc"><p>Vai percorrer o mapa e guarda a posi&#231;&#227;o onde deve colocar um '#' &#224; direita </p></div></div><div class="top"><p class="src"><a name="v:coordenadaEspiralBaixo" class="def">coordenadaEspiralBaixo</a> :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Float -&gt; [(Int, Int)]</p><div class="doc"><p>Vai percorrer o mapa e guarda a posi&#231;&#227;o onde deve colocar um '#' em baixo </p></div></div><div class="top"><p class="src"><a name="v:coordenadaEspiralEsquerda" class="def">coordenadaEspiralEsquerda</a> :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Float -&gt; [(Int, Int)]</p><div class="doc"><p>Vai percorrer o mapa e guarda a posi&#231;&#227;o onde deve colocar um '#' &#224; esquerda </p></div></div><div class="top"><p class="src"><a name="v:coordenadaEspiralCima" class="def">coordenadaEspiralCima</a> :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Float -&gt; [(Int, Int)]</p><div class="doc"><p>Vai percorrer o mapa e guarda a posi&#231;&#227;o onde deve colocar um '#' em cima</p></div></div><div class="top"><p class="src"><a name="v:desenhaEspiral" class="def">desenhaEspiral</a> :: [(Int, Int)] -&gt; [String] -&gt; Int -&gt; Int -&gt; Int -&gt; [String]</p><div class="doc"><p>Vai percorrer o mapa e desenhar o efeito espiral</p></div></div><div class="top"><p class="src"><a name="v:desenhaLinhA" class="def">desenhaLinhA</a> :: [(Int, Int)] -&gt; String -&gt; Int -&gt; Int -&gt; Int -&gt; String</p><div class="doc"><p>Desenha os '#' na linha</p></div></div><div class="top"><p class="src"><a name="v:verificaCondicao" class="def">verificaCondicao</a> :: [(Int, Int)] -&gt; Int -&gt; Int -&gt; Bool</p><div class="doc"><p>Verifica se a posi&#231;&#227;o atual corresponde a algum elemento da lista de onde deve desenhar o efeito espiral </p></div></div><div class="top"><p class="src"><a name="v:main" class="def">main</a> :: IO ()</p><div class="doc"><p>Main </p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>